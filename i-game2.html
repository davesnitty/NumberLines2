<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Imaginary Number Power Quest</title>
  <style>
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      background: #f7f7fb;
      margin: 0;
    }
    .wrap {
      max-width: 820px;
      margin: 24px auto;
      padding: 16px;
    }
    .card {
      background: white;
      border-radius: 14px;
      padding: 18px;
      box-shadow: 0 6px 22px rgba(0,0,0,.08);
    }
    h1 { margin: 0 0 6px; font-size: 22px; }
    .row { display: flex; gap: 16px; flex-wrap: wrap; align-items: flex-start; }
    .pill { background: #eef; border-radius: 999px; padding: 6px 10px; font-size: 14px; }
    .question { font-size: 44px; font-weight: 700; margin: 14px 0; }
    .grid { display: grid; grid-template-columns: repeat(4, minmax(120px, 1fr)); gap: 10px; }
    button {
      border: 0;
      border-radius: 12px;
      padding: 12px 14px;
      font-size: 18px;
      cursor: pointer;
    }
    button.choice { background: #111827; color: white; min-width: 110px; }
    button.choice:active { transform: translateY(1px); }
    button.secondary { background: #e5e7eb; }
    .msg { margin-top: 14px; font-size: 18px; min-height: 28px; }
    .good { color: #047857; font-weight: 700; }
    .bad { color: #b91c1c; font-weight: 700; }
    .tiny { font-size: 13px; color: #374151; line-height: 1.5; }
    .footer { margin-top: 14px; display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <h1>Imaginary Number Power Quest</h1>

      <div class="row">
        <div class="pill">Rule: <strong>i² = −1</strong></div>
        <div class="pill">Cycle: <strong>i → −1 → −i → 1</strong></div>
      </div>

      <div class="question" id="question">i^?</div>

      <div class="grid" id="choices">
        <button class="choice" data-ans="i">i</button>
        <button class="choice" data-ans="-1">−1</button>
        <button class="choice" data-ans="-i">−i</button>
        <button class="choice" data-ans="1">1</button>
      </div>

      <div class="msg" id="message"></div>

      <div class="footer">
        <div class="pill">Score: <strong id="score">0</strong></div>
        <div class="pill">Streak: <strong id="streak">0</strong></div>
        <button class="secondary" id="reset">Reset</button>
      </div>

      <hr style="margin:16px 0; border:0; border-top:1px solid #eee;" />

      <div class="row">
        <div class="tiny">
          <strong>Difficulty</strong><br>
          <label><input type="radio" name="diff" value="easy" checked> Easy</label><br>
          <label><input type="radio" name="diff" value="med"> Medium</label><br>
          <label><input type="radio" name="diff" value="hard"> Hard</label>
        </div>

        <div class="tiny">
          Easy → powers from 1 through 20<br>
          Medium → powers from 1 through 200<br>
          Hard → powers from 1 through 10,000
        </div>
      </div>
    </div>
  </div>

  <script>
    // Powers of i repeat every 4
    function powerOfI(n) {
      const r = ((n % 4) + 4) % 4;
      if (r === 1) return "i";
      if (r === 2) return "-1";
      if (r === 3) return "-i";
      return "1";
    }

    let currentN = 1;
    let score = 0;
    let streak = 0;

    const questionEl = document.getElementById("question");
    const messageEl = document.getElementById("message");
    const scoreEl = document.getElementById("score");
    const streakEl = document.getElementById("streak");

    function maxForDifficulty() {
      const diff = document.querySelector('input[name="diff"]:checked').value;
      if (diff === "easy") return 20;
      if (diff === "med") return 200;
      return 10000;
    }

    function newQuestion() {
      currentN = 1 + Math.floor(Math.random() * maxForDifficulty());
      questionEl.textContent = `i^${currentN}`;
      messageEl.textContent = "";
    }

    function updateScore() {
      scoreEl.textContent = score;
      streakEl.textContent = streak;
    }

    // Answer clicks
    document.getElementById("choices").addEventListener("click", (e) => {
      const btn = e.target.closest(".choice");
      if (!btn) return;

      const chosen = btn.dataset.ans;
      const correct = chosen === powerOfI(currentN);

      if (correct) {
        streak++;
        score += 10 + streak;
        messageEl.innerHTML = `<span class="good">Correct!</span>`;
      } else {
        streak = 0;
        score = Math.max(0, score - 5);
        messageEl.innerHTML =
          `<span class="bad">Not quite.</span> Answer was <strong>${powerOfI(currentN)}</strong>.`;
      }

      updateScore();

      // Auto-advance after every answer
      setTimeout(newQuestion, 600);
    });

    // Reset
    document.getElementById("reset").addEventListener("click", () => {
      score = 0;
      streak = 0;
      updateScore();
      newQuestion();
    });

    // ✅ Difficulty change: instantly refresh the question to match the new range
    document.querySelectorAll('input[name="diff"]').forEach((radio) => {
      radio.addEventListener("change", () => {
        newQuestion();
      });
    });

    // Start
    updateScore();
    newQuestion();
  </script>
</body>
</html>
